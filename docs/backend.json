{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user profile.",
      "properties": {
        "uid": { "type": "string" },
        "anonymousName": { "type": "string" }
      },
      "required": ["uid", "anonymousName"]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message within a chat room.",
      "properties": {
        "senderId": {
          "type": "string",
          "description": "The UID of the user who sent the message."
        },
        "senderName": {
            "type": "string",
            "description": "The anonymous name of the sender."
        },
        "encryptedPayload": {
          "type": "string",
          "description": "The Base64-encoded, encrypted message payload."
        },
        "timestamp": {
          "type": "object",
          "description": "Firestore server-side timestamp."
        },
        "anonymized": {
            "type": "boolean",
            "description": "Indicates if the original message content was altered by the AI."
        },
        "isEdited": {
            "type": "boolean",
            "description": "Indicates if the message has been edited."
        }
      },
      "required": ["senderId", "senderName", "encryptedPayload", "timestamp"]
    },
    "ChatRoom": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatRoom",
      "type": "object",
      "description": "Represents a chat room where users can exchange messages.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the chat room."
        },
        "createdAt": {
          "type": "object",
          "description": "Firestore server-side timestamp."
        },
        "region": {
          "type": "string",
          "description": "Geographic region of the room."
        },
        "isPublic": {
            "type": "boolean",
            "description": "Indicates if the room is a public lobby or a private room."
        },
        "participants": {
            "type": "object",
            "description": "A map of user UIDs to their public key and anonymous name."
        }
      },
      "required": ["name", "createdAt", "region", "isPublic"]
    }
  },
  "auth": {
    "providers": ["anonymous"]
  },
  "firestore": {
      "/users/{userId}": {
        "schema": { "$ref": "#/entities/User" },
        "description": "Stores user profile information, like their anonymous name."
      },
      "/chatRooms/{chatRoomId}": {
        "schema": { "$ref": "#/entities/ChatRoom" },
        "description": "Stores chat room metadata and participant public keys."
      },
      "/chatRooms/{roomId}/messages/{messageId}": {
        "schema": { "$ref": "#/entities/ChatMessage" },
        "description": "Stores all encrypted messages for a specific chat room."
      }
  }
}
