{
  "entities": {
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message within a chat.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The anonymous UID of the user who sent the message."
        },
        "username": {
          "type": "string",
          "description": "The AI-generated anonymous name of the sender."
        },
        "encryptedText": {
          "type": "string",
          "description": "The end-to-end encrypted text content of the message."
        },
        "timestamp": {
          "type": "object",
          "description": "Firestore server-side timestamp of when the message was sent."
        },
        "anonymized": {
            "type": "boolean",
            "description": "Indicates if the message content was altered by the AI anonymizer."
        },
        "file": {
            "type": "object",
            "properties": {
                "name": {"type": "string"},
                "type": {"type": "string"},
                "data": {"type": "string"}
            }
        }
      },
      "required": ["userId", "username", "encryptedText", "timestamp"]
    },
    "ChatRoom": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatRoom",
      "type": "object",
      "description": "Represents a chat room where users can exchange messages.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the chat room."
        },
        "createdAt": {
          "type": "object",
          "description": "Firestore server-side timestamp of when the room was created."
        },
        "region": {
          "type": "string",
          "description": "Geographic region the chat room is associated with."
        },
        "isPublic": {
            "type": "boolean",
            "description": "Indicates if the room is a public lobby or a private room."
        }
      },
      "required": ["name", "createdAt", "region", "isPublic"]
    }
  },
  "auth": {
    "providers": ["anonymous"]
  },
  "firestore": {
      "/chatRooms/{chatRoomId}": {
        "schema": { "$ref": "#/entities/ChatRoom" },
        "description": "Stores chat room metadata, including name, region, and creation timestamp."
      },
      "/chatRooms/{chatRoomId}/messages/{messageId}": {
        "schema": { "$ref": "#/entities/ChatMessage" },
        "description": "Stores all messages for a specific chat room."
      }
  }
}
